(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("ol"),require("quasar"),require("vue")):"function"===typeof define&&define.amd?define([,,],e):"object"===typeof exports?exports["VertigoUi"]=e(require("ol"),require("quasar"),require("vue")):t["VertigoUi"]=e(t["ol"],t["Quasar"],t["Vue"])})("undefined"!==typeof self?self:this,(function(t,e,n){return function(){var o={9662:function(t,e,n){var o=n(614),a=n(6330),i=TypeError;t.exports=function(t){if(o(t))return t;throw i(a(t)+" is not a function")}},9670:function(t,e,n){var o=n(111),a=String,i=TypeError;t.exports=function(t){if(o(t))return t;throw i(a(t)+" is not an object")}},1318:function(t,e,n){var o=n(5656),a=n(1400),i=n(6244),s=function(t){return function(e,n,s){var r,c=o(e),l=i(c),u=a(s,l);if(t&&n!=n){while(l>u)if(r=c[u++],r!=r)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},3658:function(t,e,n){"use strict";var o=n(9781),a=n(3157),i=TypeError,s=Object.getOwnPropertyDescriptor,r=o&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=r?function(t,e){if(a(t)&&!s(t,"length").writable)throw i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4326:function(t,e,n){var o=n(1702),a=o({}.toString),i=o("".slice);t.exports=function(t){return i(a(t),8,-1)}},9920:function(t,e,n){var o=n(2597),a=n(3887),i=n(1236),s=n(3070);t.exports=function(t,e,n){for(var r=a(e),c=s.f,l=i.f,u=0;u<r.length;u++){var d=r[u];o(t,d)||n&&o(n,d)||c(t,d,l(e,d))}}},8880:function(t,e,n){var o=n(9781),a=n(3070),i=n(9114);t.exports=o?function(t,e,n){return a.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},9114:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},8052:function(t,e,n){var o=n(614),a=n(3070),i=n(6339),s=n(3072);t.exports=function(t,e,n,r){r||(r={});var c=r.enumerable,l=void 0!==r.name?r.name:e;if(o(n)&&i(n,l,r),r.global)c?t[e]=n:s(e,n);else{try{r.unsafe?t[e]&&(c=!0):delete t[e]}catch(u){}c?t[e]=n:a.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t}},3072:function(t,e,n){var o=n(7854),a=Object.defineProperty;t.exports=function(t,e){try{a(o,t,{value:e,configurable:!0,writable:!0})}catch(n){o[t]=e}return e}},9781:function(t,e,n){var o=n(7293);t.exports=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(t){var e="object"==typeof document&&document.all,n="undefined"==typeof e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:n}},317:function(t,e,n){var o=n(7854),a=n(111),i=o.document,s=a(i)&&a(i.createElement);t.exports=function(t){return s?i.createElement(t):{}}},7207:function(t){var e=TypeError,n=9007199254740991;t.exports=function(t){if(t>n)throw e("Maximum allowed index exceeded");return t}},8113:function(t){t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:function(t,e,n){var o,a,i=n(7854),s=n(8113),r=i.process,c=i.Deno,l=r&&r.versions||c&&c.version,u=l&&l.v8;u&&(o=u.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&s&&(o=s.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=s.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),t.exports=a},748:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(t,e,n){var o=n(7854),a=n(1236).f,i=n(8880),s=n(8052),r=n(3072),c=n(9920),l=n(4705);t.exports=function(t,e){var n,u,d,p,f,h,m=t.target,g=t.global,v=t.stat;if(u=g?o:v?o[m]||r(m,{}):(o[m]||{}).prototype,u)for(d in e){if(f=e[d],t.dontCallGetSet?(h=a(u,d),p=h&&h.value):p=u[d],n=l(g?d:m+(v?".":"#")+d,t.forced),!n&&void 0!==p){if(typeof f==typeof p)continue;c(f,p)}(t.sham||p&&p.sham)&&i(f,"sham",!0),s(u,d,f,t)}}},7293:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},4374:function(t,e,n){var o=n(7293);t.exports=!o((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},6916:function(t,e,n){var o=n(4374),a=Function.prototype.call;t.exports=o?a.bind(a):function(){return a.apply(a,arguments)}},6530:function(t,e,n){var o=n(9781),a=n(2597),i=Function.prototype,s=o&&Object.getOwnPropertyDescriptor,r=a(i,"name"),c=r&&"something"===function(){}.name,l=r&&(!o||o&&s(i,"name").configurable);t.exports={EXISTS:r,PROPER:c,CONFIGURABLE:l}},1702:function(t,e,n){var o=n(4374),a=Function.prototype,i=a.call,s=o&&a.bind.bind(i,i);t.exports=o?s:function(t){return function(){return i.apply(t,arguments)}}},5005:function(t,e,n){var o=n(7854),a=n(614),i=function(t){return a(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?i(o[t]):o[t]&&o[t][e]}},8173:function(t,e,n){var o=n(9662),a=n(8554);t.exports=function(t,e){var n=t[e];return a(n)?void 0:o(n)}},7854:function(t,e,n){var o=function(t){return t&&t.Math==Math&&t};t.exports=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:function(t,e,n){var o=n(1702),a=n(7908),i=o({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(a(t),e)}},3501:function(t){t.exports={}},4664:function(t,e,n){var o=n(9781),a=n(7293),i=n(317);t.exports=!o&&!a((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},8361:function(t,e,n){var o=n(1702),a=n(7293),i=n(4326),s=Object,r=o("".split);t.exports=a((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?r(t,""):s(t)}:s},2788:function(t,e,n){var o=n(1702),a=n(614),i=n(5465),s=o(Function.toString);a(i.inspectSource)||(i.inspectSource=function(t){return s(t)}),t.exports=i.inspectSource},9909:function(t,e,n){var o,a,i,s=n(4811),r=n(7854),c=n(111),l=n(8880),u=n(2597),d=n(5465),p=n(6200),f=n(3501),h="Object already initialized",m=r.TypeError,g=r.WeakMap,v=function(t){return i(t)?a(t):o(t,{})},b=function(t){return function(e){var n;if(!c(e)||(n=a(e)).type!==t)throw m("Incompatible receiver, "+t+" required");return n}};if(s||d.state){var y=d.state||(d.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,o=function(t,e){if(y.has(t))throw m(h);return e.facade=t,y.set(t,e),e},a=function(t){return y.get(t)||{}},i=function(t){return y.has(t)}}else{var x=p("state");f[x]=!0,o=function(t,e){if(u(t,x))throw m(h);return e.facade=t,l(t,x,e),e},a=function(t){return u(t,x)?t[x]:{}},i=function(t){return u(t,x)}}t.exports={set:o,get:a,has:i,enforce:v,getterFor:b}},3157:function(t,e,n){var o=n(4326);t.exports=Array.isArray||function(t){return"Array"==o(t)}},614:function(t,e,n){var o=n(4154),a=o.all;t.exports=o.IS_HTMLDDA?function(t){return"function"==typeof t||t===a}:function(t){return"function"==typeof t}},4705:function(t,e,n){var o=n(7293),a=n(614),i=/#|\.prototype\./,s=function(t,e){var n=c[r(t)];return n==u||n!=l&&(a(e)?o(e):!!e)},r=s.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},8554:function(t){t.exports=function(t){return null===t||void 0===t}},111:function(t,e,n){var o=n(614),a=n(4154),i=a.all;t.exports=a.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:o(t)||t===i}:function(t){return"object"==typeof t?null!==t:o(t)}},1913:function(t){t.exports=!1},2190:function(t,e,n){var o=n(5005),a=n(614),i=n(7976),s=n(3307),r=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=o("Symbol");return a(e)&&i(e.prototype,r(t))}},6244:function(t,e,n){var o=n(7466);t.exports=function(t){return o(t.length)}},6339:function(t,e,n){var o=n(1702),a=n(7293),i=n(614),s=n(2597),r=n(9781),c=n(6530).CONFIGURABLE,l=n(2788),u=n(9909),d=u.enforce,p=u.get,f=String,h=Object.defineProperty,m=o("".slice),g=o("".replace),v=o([].join),b=r&&!a((function(){return 8!==h((function(){}),"length",{value:8}).length})),y=String(String).split("String"),x=t.exports=function(t,e,n){"Symbol("===m(f(e),0,7)&&(e="["+g(f(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||c&&t.name!==e)&&(r?h(t,"name",{value:e,configurable:!0}):t.name=e),b&&n&&s(n,"arity")&&t.length!==n.arity&&h(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?r&&h(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(a){}var o=d(t);return s(o,"source")||(o.source=v(y,"string"==typeof e?e:"")),t};Function.prototype.toString=x((function(){return i(this)&&p(this).source||l(this)}),"toString")},4758:function(t){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var o=+t;return(o>0?n:e)(o)}},3070:function(t,e,n){var o=n(9781),a=n(4664),i=n(3353),s=n(9670),r=n(4948),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",p="configurable",f="writable";e.f=o?i?function(t,e,n){if(s(t),e=r(e),s(n),"function"===typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var o=u(t,e);o&&o[f]&&(t[e]=n.value,n={configurable:p in n?n[p]:o[p],enumerable:d in n?n[d]:o[d],writable:!1})}return l(t,e,n)}:l:function(t,e,n){if(s(t),e=r(e),s(n),a)try{return l(t,e,n)}catch(o){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},1236:function(t,e,n){var o=n(9781),a=n(6916),i=n(5296),s=n(9114),r=n(5656),c=n(4948),l=n(2597),u=n(4664),d=Object.getOwnPropertyDescriptor;e.f=o?d:function(t,e){if(t=r(t),e=c(e),u)try{return d(t,e)}catch(n){}if(l(t,e))return s(!a(i.f,t,e),t[e])}},8006:function(t,e,n){var o=n(6324),a=n(748),i=a.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,i)}},5181:function(t,e){e.f=Object.getOwnPropertySymbols},7976:function(t,e,n){var o=n(1702);t.exports=o({}.isPrototypeOf)},6324:function(t,e,n){var o=n(1702),a=n(2597),i=n(5656),s=n(1318).indexOf,r=n(3501),c=o([].push);t.exports=function(t,e){var n,o=i(t),l=0,u=[];for(n in o)!a(r,n)&&a(o,n)&&c(u,n);while(e.length>l)a(o,n=e[l++])&&(~s(u,n)||c(u,n));return u}},5296:function(t,e){"use strict";var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,a=o&&!n.call({1:2},1);e.f=a?function(t){var e=o(this,t);return!!e&&e.enumerable}:n},2140:function(t,e,n){var o=n(6916),a=n(614),i=n(111),s=TypeError;t.exports=function(t,e){var n,r;if("string"===e&&a(n=t.toString)&&!i(r=o(n,t)))return r;if(a(n=t.valueOf)&&!i(r=o(n,t)))return r;if("string"!==e&&a(n=t.toString)&&!i(r=o(n,t)))return r;throw s("Can't convert object to primitive value")}},3887:function(t,e,n){var o=n(5005),a=n(1702),i=n(8006),s=n(5181),r=n(9670),c=a([].concat);t.exports=o("Reflect","ownKeys")||function(t){var e=i.f(r(t)),n=s.f;return n?c(e,n(t)):e}},4488:function(t,e,n){var o=n(8554),a=TypeError;t.exports=function(t){if(o(t))throw a("Can't call method on "+t);return t}},6200:function(t,e,n){var o=n(2309),a=n(9711),i=o("keys");t.exports=function(t){return i[t]||(i[t]=a(t))}},5465:function(t,e,n){var o=n(7854),a=n(3072),i="__core-js_shared__",s=o[i]||a(i,{});t.exports=s},2309:function(t,e,n){var o=n(1913),a=n(5465);(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.29.1",mode:o?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(t,e,n){var o=n(7392),a=n(7293);t.exports=!!Object.getOwnPropertySymbols&&!a((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&o&&o<41}))},1400:function(t,e,n){var o=n(9303),a=Math.max,i=Math.min;t.exports=function(t,e){var n=o(t);return n<0?a(n+e,0):i(n,e)}},5656:function(t,e,n){var o=n(8361),a=n(4488);t.exports=function(t){return o(a(t))}},9303:function(t,e,n){var o=n(4758);t.exports=function(t){var e=+t;return e!==e||0===e?0:o(e)}},7466:function(t,e,n){var o=n(9303),a=Math.min;t.exports=function(t){return t>0?a(o(t),9007199254740991):0}},7908:function(t,e,n){var o=n(4488),a=Object;t.exports=function(t){return a(o(t))}},7593:function(t,e,n){var o=n(6916),a=n(111),i=n(2190),s=n(8173),r=n(2140),c=n(5112),l=TypeError,u=c("toPrimitive");t.exports=function(t,e){if(!a(t)||i(t))return t;var n,c=s(t,u);if(c){if(void 0===e&&(e="default"),n=o(c,t,e),!a(n)||i(n))return n;throw l("Can't convert object to primitive value")}return void 0===e&&(e="number"),r(t,e)}},4948:function(t,e,n){var o=n(7593),a=n(2190);t.exports=function(t){var e=o(t,"string");return a(e)?e:e+""}},6330:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},9711:function(t,e,n){var o=n(1702),a=0,i=Math.random(),s=o(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++a+i,36)}},3307:function(t,e,n){var o=n(6293);t.exports=o&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(t,e,n){var o=n(9781),a=n(7293);t.exports=o&&a((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(t,e,n){var o=n(7854),a=n(614),i=o.WeakMap;t.exports=a(i)&&/native code/.test(String(i))},5112:function(t,e,n){var o=n(7854),a=n(2309),i=n(2597),s=n(9711),r=n(6293),c=n(3307),l=o.Symbol,u=a("wks"),d=c?l["for"]||l:l&&l.withoutSetter||s;t.exports=function(t){return i(u,t)||(u[t]=r&&i(l,t)?l[t]:d("Symbol."+t)),u[t]}},7658:function(t,e,n){"use strict";var o=n(2109),a=n(7908),i=n(6244),s=n(3658),r=n(7207),c=n(7293),l=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},d=l||!u();o({target:"Array",proto:!0,arity:1,forced:d},{push:function(t){var e=a(this),n=i(e),o=arguments.length;r(n+o);for(var c=0;c<o;c++)e[n]=arguments[c],n++;return s(e,n),n}})},5015:function(e){"use strict";e.exports=t},728:function(t){"use strict";t.exports=e},7203:function(t){"use strict";t.exports=n}},a={};function i(t){var e=a[t];if(void 0!==e)return e.exports;var n=a[t]={exports:{}};return o[t](n,n.exports,i),n.exports}!function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.p=""}();var s={};return function(){"use strict";if(i.r(s),i.d(s,{getBoundMethods:function(){return Ut},initData:function(){return Vt},install:function(){return It},methods:function(){return Bt}}),"undefined"!==typeof window){var t=window.document.currentScript,e=t&&t.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);e&&(i.p=e[1])}var n=i(728),o=i.n(n),a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bot"},[e("q-scroll-area",{ref:"scroller",staticClass:"bg-grey-2 col-grow row q-pa-sm"},[e("div",{staticClass:"q-pr-md"},[t._l(t.messages,(function(n,o){return e("div",{key:o},[n.rating?e("q-chat-message",{key:"msgRating-"+o,staticClass:"animate-fade",attrs:{sent:n.sent,"bg-color":n.bgColor,avatar:n.avatar}},[e("q-rating",{staticStyle:{"font-size":"2rem"},attrs:{max:5,readonly:""},model:{value:n.rating,callback:function(e){t.$set(n,"rating",e)},expression:"msg.rating"}})],1):t._e(),n.text?e("q-chat-message",{key:"msg-"+o,staticClass:"animate-fade",attrs:{label:n.label,sent:n.sent,"text-color":n.textColor,"bg-color":n.bgColor,name:n.name,avatar:n.avatar,text:n.text,stamp:n.stamp}}):t._e()],1)})),e("div",{staticClass:"sys-chat"},[t.error?e("q-chat-message",{staticClass:"animate-fade",attrs:{"bg-color":"orange-4","text-color":"black",size:"12"}},[e("div",{staticClass:"q-pb-sm"},[t._v(" "+t._s(t.$q.lang.vui.chatbot.errorMessage)+" ")]),e("q-btn",{staticClass:"full-width",attrs:{label:t.$q.lang.vui.chatbot.tryAgain,color:"white","text-color":"black"},on:{click:function(e){return t.askBot(t.lastPayload)}}})],1):t._e()],1),e("div",{staticClass:"sys-chat non-selectable"},[t.inputConfig.buttons.length>0?e("q-chat-message",{staticClass:"animate-fade",attrs:{"bg-color":"primary",size:"12"}},[e("div",{staticClass:"text-blue-2 q-caption"},[t._v(" "+t._s(t.$q.lang.vui.suggestedAnswers)+" ")]),e("div",{staticClass:"row docs-btn"},t._l(t.inputConfig.buttons,(function(n,o){return e("q-btn",{key:"repChatBtn-"+o,staticClass:"full-width",attrs:{label:n.title,color:"white","text-color":"black"},on:{click:function(e){return t.postAnswerBtn(n)}}})})),1)]):t._e()],1),e("div",{staticClass:"message-processing sys-chat non-selectable"},[t.processing?e("q-chat-message",{staticClass:"animate-fade",attrs:{"bg-color":"grey-4"}},[e("q-spinner-dots",{attrs:{size:"2em"}})],1):t._e()],1),e("div",{staticClass:"non-selectable"},[t.inputConfig.showRating?e("q-chat-message",{staticClass:"animate-fade",attrs:{"bg-color":"primary",sent:""}},[e("q-rating",{staticStyle:{"font-size":"2rem"},attrs:{max:4},model:{value:t.rating,callback:function(e){t.rating=e},expression:"rating"}})],1):t._e()],1)],2)]),e("div",{staticClass:"message-response row docs-btn q-pl-sm non-selectable"},[e("q-input",{ref:"input",staticClass:"col-grow",attrs:{type:t.inputConfig.modeTextarea?"textarea":"text","max-height":100,placeholder:t.$q.lang.vui.chatbot.inputPlaceholder,disable:t.processing||t.error,loading:t.processing},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;!t.inputConfig.modeTextarea&&((""!==t.inputConfig.responseText.trim()||0!==t.inputConfig.rating)&&t.postAnswerText())}},model:{value:t.inputConfig.responseText,callback:function(e){t.$set(t.inputConfig,"responseText",e)},expression:"inputConfig.responseText"}}),e("q-btn",{attrs:{round:"",color:"primary",icon:"send",disable:t.processing||""===t.inputConfig.responseText.trim()&&0===t.inputConfig.rating},on:{click:function(e){return t.postAnswerText()}}}),!0===t.devMode?e("q-btn",{attrs:{round:"",color:"red",icon:"refresh"},on:{click:t.restart}}):t._e()],1)],1)},r=[],c=(i(7658),{props:{botUrl:{type:String,required:!0},devMode:{type:Boolean,default:!1},minTimeBetweenMessages:{type:Number,default:1e3},botAvatar:{type:String,required:!0},botName:{type:String,required:!0}},data:function(){return{convId:42,inputConfig:{modeTextarea:!1,responseText:"",responsePattern:"",showRating:!1,rating:0,buttons:[]},prevInputConfig:{},lastPayload:null,processing:!1,error:!1,messages:[],keepAction:!1,menu:!1,lastUserInteraction:0,watingMessagesStack:[]}},created:function(){this.askBot("/start"),this.convId=Math.random()},methods:{postAnswerBtn:function(t){this.messages.push({text:[t.title],sent:!0,bgColor:"primary",textColor:"white"}),this._scrollToBottom(),this.askBot(t.payload)},postAnswerText:function(){var t=this.inputConfig.responseText.trim().replace(/(?:\r\n|\r|\n)/g,"<br>");this.messages.push({text:""!==t?[t]:null,rating:this.inputConfig.rating>0?this.inputConfig.rating:null,sent:!0,bgColor:"primary",textColor:"white"}),this._scrollToBottom();var e=""===this.inputConfig.responsePattern?t.replace(/(")/g,'"'):this.inputConfig.responsePattern.replace("#",t.replace(/(")/g,'\\"'));this.askBot(e)},_scrollToBottom:function(){this.$refs.scroller&&this.$refs.scroller.setScrollPosition(this.$refs.scroller.scrollHeight,400)},askBot:function(t){this.prevInputConfig=JSON.parse(JSON.stringify(this.inputConfig)),this.reinitInput(),this.lastPayload=t,this.processing=!0,this.lastUserInteraction=Date.now(),this.$http.post(this.botUrl,{sender:this.convId,message:t}).then(function(t){t.data.forEach((function(t){this.watingMessagesStack.push(t)}),this),this._displayMessages()}.bind(this)).catch(function(){this.error=!0,this.processing=!1,this._scrollToBottom()}.bind(this))},_displayMessages:function(){if(this.watingMessagesStack.length>0){var t=this.watingMessagesStack.shift(),e=this.lastUserInteraction-Date.now()+this.minTimeBetweenMessages;this.sleep(e).then(function(){this._processResponse(t),this.lastUserInteraction=Date.now(),this._displayMessages()}.bind(this))}else this.processing=!1,this.keepAction&&(this.inputConfig=this.prevInputConfig,this.inputConfig.responseText="",this.keepAction=!1),this.sleep(1).then(function(){this.$refs.input.focus()}.bind(this))},_processResponse:function(t){var e=this.messages[this.messages.length-1];e&&!e.sent?e.text.push(t.text):this.messages.push({avatar:this.botAvatar,text:[t.text],bgColor:"grey-4"}),t.buttons&&t.buttons.forEach((function(t){if(t.title.startsWith("#")){var e=t.title.substring(1);"textarea"===e&&(this.inputConfig.modeTextarea=!0),"eval"===e&&(this.inputConfig.showRating=!0),"keep_action"===e&&(this.keepAction=!0),t.payload&&(this.inputConfig.responsePattern=t.payload)}else this.inputConfig.buttons.push(t)}),this),this._scrollToBottom()},restart:function(){this.messages.push({text:[this.$q.lang.vui.chatbot.restartMessage],bgColor:"orange"}),this._scrollToBottom(),this.$http.post(this.botUrl,'{"sender":"'+this.convId+'","message":"/restart"}').then(function(){this.askBot("/start")}.bind(this))},reinitInput:function(){this.inputConfig.modeTextarea=!1,this.inputConfig.responsePattern="",this.inputConfig.responseText="",this.inputConfig.showRating=!1,this.inputConfig.rating=0,this.inputConfig.buttons=[],this.error=!1},sleep:function(t){return new Promise((function(e){setTimeout(e,t)}))}}}),l=c;function u(t,e,n,o,a,i,s,r){var c,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),o&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),s?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},l._ssrRegister=c):a&&(c=r?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:l}}var d=u(l,a,r,!1,null,null,null),p=d.exports,f=function(){var t=this,e=t._self._c;return e("div",[t.isCommandCommited?e("div",{staticClass:"row col-12 justify-between bg-white round-borders overflow-hidden shadow-2 text-black",nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.executeCommand.apply(null,arguments)}}},[e("div",{staticClass:"bg-grey-4 text-center vertical-middle text-bold q-px-md",staticStyle:{"line-height":"40px"}},[t._v(t._s(t.selectedCommand.commandName))]),t.isExecuted?e("div",{staticClass:"row col items-center"},[e("div",{staticClass:"col shadow-2 bg-secondary text-white q-px-md",staticStyle:{"line-height":"40px"}},[t._v(t._s(t.commandResult.display))]),t.commandResult.targetUrl?e("q-btn",{attrs:{type:"a",href:t.baseUrl+t.commandResult.targetUrl,flat:""}},[t._v(t._s(t.$q.lang.vui.commands.linkLabel))]):t._e(),e("q-btn",{attrs:{flat:"",icon:"cancel",size:"sm",round:""},on:{click:t.reset}})],1):e("div",{staticClass:"row col items-center q-py-xs"},[t.selectedCommand.commandParams&&t.selectedCommand.commandParams.length>0?[t._l(t.selectedCommand.commandParams,(function(n,o){return["io.vertigo.commons.command.GenericUID"===n.paramType.rawType?[e("q-select",{key:n,staticClass:"col q-px-xs",staticStyle:{height:"32px"},attrs:{"use-chips":"","bg-color":"white",dense:"",borderless:"","use-input":"","input-debounce":"300",value:t.getParamValue(o),options:t.paramsAutocompleteOptions[o],autofocus:0===o,"dropdown-icon":"search"},on:{filter:function(e,a,i){t.autocompleteParam(n,o,e,a,i)},input:function(e){t.selectParam(e,o)}},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:function(e){t.backIfNeeded(e,0===o)}.apply(null,arguments)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:function(e){t.backIfNeeded(e,0===o)}.apply(null,arguments)}}})]:[e("q-input",{key:n,staticClass:"col q-px-xs",staticStyle:{height:"32px"},attrs:{color:"secondary",borderless:"",autofocus:0===o,dense:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:function(e){t.backIfNeeded(e,0===o)}.apply(null,arguments)},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:function(e){t.backIfNeeded(e,0===o)}.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleEnter(o)}]},model:{value:t.commandParamsValues[o].value,callback:function(e){t.$set(t.commandParamsValues[o],"value",e)},expression:"commandParamsValues[index].value"}})],e("q-separator",{key:n,attrs:{vertical:""}})]}))]:e("div",{staticClass:"col"},[t._v(t._s(t.$q.lang.vui.commands.executeCommand))]),e("q-btn",{attrs:{flat:"",icon:"play_arrow",size:"sm",round:""},on:{click:t.executeCommand}})],2)]):e("q-select",{ref:"commandInput",attrs:{placeholder:t.$q.lang.vui.commands.globalPlaceholder,outlined:"","bg-color":"white",dense:"",autofocus:"","dropdown-icon":"search","use-input":"","input-debounce":"300","hide-selected":"",options:t.commandAutocompleteOptions},on:{blur:t.reset,filter:t.searchCommands,input:t.selectCommand},nativeOn:{keydown:function(e){return t.commitCommand.apply(null,arguments)}}},[""!==t.text&&t.selectedCommand.commandName&&t.selectedCommand.commandName.startsWith(t.text)?e("span",{staticStyle:{"line-height":"40px",opacity:"0.5",position:"fixed"}},[t._v(t._s(t.selectedCommand.commandName))]):t._e()])],1)},h=[],m={data:function(){return{text:"",commandParamsValues:[],commands:[],commandAutocompleteOptions:[],isCommandCommited:!1,selectedCommand:{},isExecuted:!1,commandResult:{},paramsAutocompleteOptions:[]}},props:{baseUrl:{type:String,default:"/"}},methods:{searchCommands:function(t,e,n){this.$data.text=t,this.$data.selectedCommand={},t.length<1?n():this.$http.post(this.baseUrl+"api/vertigo/commands/_search",{prefix:t}).then(function(t){this.$data.commands=t.data,e(function(){this.$data.commandAutocompleteOptions=this.$data.commands.map((function(t){return{label:t.commandName,sublabel:t.descpription,value:t.commandName,command:t}}))}.bind(this)),this.$data.commands.length>0&&this.chooseCommand(this.$data.commands[0],!1)}.bind(this))},selectCommand:function(t){this.chooseCommand(t.command,!0)},chooseCommand:function(t,e){this.$data.selectedCommand=t,this.$data.selectedCommand.commandParams?this.$data.commandParamsValues=this.$data.selectedCommand.commandParams.map((function(){return{value:""}})):this.$data.commandParamsValues=[],this.$data.isCommandCommited=e},commitCommand:function(t){if(this.$data.selectedCommand&&this.$data.selectedCommand.commandName)switch(t.keyCode){case 9:case 13:this.$data.isCommandCommited=!0,t.preventDefault()}},executeCommand:function(){if(!this.$data.commandParamsValues.every((function(t){return t})))return!1;var t=this.$data.commandParamsValues.map((function(t){return t.value}));this.$http.post(this.baseUrl+"api/vertigo/commands/_execute",{command:this.$data.selectedCommand.commandName,params:t}).then(function(t){this.$data.isExecuted=!0,this.$data.commandResult=t.data}.bind(this))},handleEnter:function(t){t===this.$data.selectedCommand.commandParams.length-1&&this.$data.commandParamsValues[t].value&&this.executeCommand()},autocompleteParam:function(t,e,n,o,a){n.length<1?a():this.$http.get(this.baseUrl+"api/vertigo/commands/params/_autocomplete",{params:{terms:n,entityClass:t.paramType.actualTypeArguments[0]}}).then(function(t){o(function(){var n=this.$data.paramsAutocompleteOptions.slice();n[e]=t.data.map((function(t){return{label:t.label,value:t.urn}})),this.$data.paramsAutocompleteOptions=n}.bind(this))}.bind(this))},selectParam:function(t,e){var n=this.$data.commandParamsValues.slice();n[e]=t,this.$data.commandParamsValues=n},getParamValue(t){var e=this.$data.commandParamsValues[t];if(e&&e.value)return e},backIfNeeded:function(t,e){e&&!this.$data.commandParamsValues[0].value&&this.back()},back:function(){this.$data.commandParamsValues=[],this.$data.commands=[],this.$data.isCommandCommited=!1,this.$data.selectedCommand={},this.$data.isExecuted=!1,this.$data.commandResult={},this.$data.paramsAutocompleteOptions=[],this.$nextTick((function(){this.$refs.commandInput.updateInputValue(this.$data.text)}))},reset:function(){this.back(),this.$data.text=""}}},g=m,v=u(g,f,h,!1,null,null,null),b=v.exports,y=function(){var t=this,e=t._self._c;return e("span",[e("q-btn",{staticClass:"on-left",attrs:{round:"",size:"lg",color:"primary",textColor:"white",icon:t.count>0?t.icon:t.iconNone},on:{click:function(e){t.commentDrawer=!t.commentDrawer}}},[t.count>0?e("q-badge",{staticStyle:{right:"-.4em",top:"-.4em"},attrs:{floating:"",small:"",color:"red"}},[t._v(t._s(t.count))]):t._e()],1),e("q-drawer",{staticStyle:{top:"58px"},attrs:{overlay:"",behavior:"mobile",width:600,side:"right"},model:{value:t.commentDrawer,callback:function(e){t.commentDrawer=e},expression:"commentDrawer"}},[e("q-list",[e("q-item-label",{attrs:{header:""}},[e("big",[t._v(t._s(t.$q.lang.vui.comments.title))])],1),e("q-item",[e("q-item-section",[e("q-input",{staticClass:"col",attrs:{type:"textarea",autogrow:"",label:t.$q.lang.vui.comments.inputLabel,"stack-label":""},model:{value:t.commentTextArea,callback:function(e){t.commentTextArea=e},expression:"commentTextArea"}})],1),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{color:"primary",round:"",icon:"send",title:t.$q.lang.vui.comments.actionLabel,"aria-label":t.$q.lang.vui.comments.actionLabel},on:{click:t.publishComment}})],1)],1),e("q-separator"),t._l(t.list,(function(n){return e("q-item",{key:n.uuid,staticClass:"items-start",class:{"cursor-pointer":n.author==t.connectedAccount}},[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",[e("img",{attrs:{src:t.baseUrl+"x/accounts/api/"+n.author+"/photo"}})])],1),e("q-item-section",[e("q-item-label",[t._v(t._s(n.authorDisplayName))]),e("div",[t._v(" "+t._s(n.msg)+" ")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",{attrs:{stamp:""}},[t._v(t._s(t.toDelay(new Date(n.creationDate))))]),n.author==t.connectedAccount?e("q-icon",{attrs:{name:"edit"}}):t._e()],1),n.author==t.connectedAccount?e("q-popup-edit",{attrs:{buttons:!0,"label-cancel":t.$q.lang.vui.comments.cancel,"label-set":t.$q.lang.vui.comments.save},on:{save:function(e){return t.updateComment(n)}}},[e("q-input",{attrs:{type:"textarea",autogrow:"",dense:""},model:{value:n.msg,callback:function(e){t.$set(n,"msg",e)},expression:"comment.msg"}})],1):t._e()],1)}))],2)],1)],1)},x=[],w={props:{concept:{type:String},id:{type:String},icon:{type:String,default:"comment"},iconNone:{type:String,default:"add_comment"},baseUrl:{type:String,default:"/api/",required:!0},connectedAccount:{type:String}},data:function(){return{list:[],count:0,commentDrawer:!1,commentTextArea:""}},created:function(){this.fetchCommentsList()},methods:{fetchCommentsList:function(){this.$http.get(this.baseUrl+"x/comment/api/comments?concept="+this.concept+"&id="+this.id).then(function(t){this.list=t.data,this.count=this.list.length}.bind(this))},publishComment:function(){var t={msg:this.commentTextArea};t.msg&&(t.concept=this.concept,t.id=this.id,this.$http.post(this.baseUrl+"x/comment/api/comments?concept="+this.concept+"&id="+this.id,t).then(function(){this.commentTextArea="",this.fetchCommentsList()}.bind(this)))},updateComment:function(t){this.$http.put(this.baseUrl+"x/comment/api/comments/"+t.uuid,t).then(function(){this.commentTextArea="",this.fetchCommentsList()}.bind(this))},toDelay:function(t){let e=o().utils.date.getDateDiff(Date.now(),t,"days");return e>0?e+" days":(e=o().utils.date.getDateDiff(Date.now(),t,"hours"),e>0?e+" hours":(e=o().utils.date.getDateDiff(Date.now(),t,"minutes"),e>0?e+" min":"Now"))}}},$=w,C=u($,y,x,!1,null,null,null),S=C.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row q-col-gutter-md"},t._l(t.extensions,(function(n){return e("div",{key:n.name,staticClass:"col-xs-12 col-lg-6 col-xl-4"},[e("q-card",[e("q-item",{staticClass:"bg-white",staticStyle:{height:"100px"}},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{style:t.getIconStyle(n.color),attrs:{name:n.icon,size:"40px"}})],1),e("q-item-section",[e("div",{staticClass:"row col items-center"},[e("div",{staticClass:"q-subheading text-bold"},[t._v(t._s(n.label))]),e("div",{staticClass:"col"}),e("div",[e("q-toggle",{attrs:{disable:"",readonly:"",color:"positive"},model:{value:n.enabled,callback:function(e){t.$set(n,"enabled",e)},expression:"extension.enabled"}})],1)]),e("div",{staticClass:"row col q-body-2 text-justify"},[t._v(t._s(n.description))])])],1)],1)],1)})),0)},k=[],D={props:{activeSkills:{type:Array,required:!0}},data:function(){return{extensions:[]}},created:function(){var t=[{name:"vertigo-audit",label:"Audit",description:"Trace every single aspect of your app through exhaustive logging capabilities.",color:"#F7578C",icon:"fas fa-clipboard-list",enabled:!1},{name:"vertigo-dashboard",label:"Dashboard",description:"Monitor you system to make sure your app meets the customer requirements.",color:"#742774",icon:"fas fa-chart-line",enabled:!1},{name:"vertigo-geo",label:"Geo",description:"Enhance your data by enabling geographic functions and tools.",icon:"fas fa-globe",color:"#0E2947",enabled:!1},{name:"vertigo-ledger",label:"Ledger",description:"Use a blockchain to enforce secure transactions in your app !",icon:"fas fa-link",color:"#00AC5C",enabled:!1},{name:"vertigo-orchestra",label:"Orchestra",description:"Manage jobs and monitor their status with this powerfull control tower.",color:"#FC636B",icon:"fas fa-tasks",enabled:!1},{name:"vertigo-quarto",label:"Quarto",description:"Generate slick documents and reports using the Quarto template engine.",color:"#0747A6",icon:"fas fa-file-invoice",enabled:!1},{name:"vertigo-social",label:"Social",description:"Ensure real time communication and collaboration between your app users.",color:"#FF3366",icon:"far fa-comments",enabled:!1},{name:"vertigo-stella",label:"Stella",description:"Enable multi-node task dispatching for your app and assign specific tasks to each node.",color:"#0066FF",icon:"fas fa-network-wired",enabled:!1}];t.forEach(function(t){t.enabled=this.$props.activeSkills.indexOf(t.name)>-1}.bind(this)),this.extensions=t},methods:{getIconStyle:function(t){return"border: 3px solid "+t+"; background-color: "+t+"; color: white; padding: 5px; width: 70px; height: 70px;"}}},q=D,O=u(q,_,k,!1,null,null,null),T=O.exports,E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"facets"},[t.isAnyFacetValueSelected()?e("div",{staticClass:"selectedFacets q-pb-md"},t._l(t.selectedFacets,(function(n,o){return e("div",{key:o},[t.facetMultipleByCode(o)?t._e():t._l(n,(function(n){return e("q-chip",{key:n.code,staticClass:"q-mb-sm",attrs:{clickable:"","icon-right":"cancel"},on:{click:function(e){return t.$emit("toogle-facet",o,n,t.contextKey)}}},[t._v(t._s(t.facetLabelByCode(o))+": "+t._s(t.facetValueLabelByCode(o,n))+" ")])}))],2)})),0):t._e(),t._l(t.facets,(function(n){return e("q-list",{key:n.code,staticClass:"facetValues q-py-none",attrs:{dense:""}},[n.multiple||!t.isFacetSelected(n.code)?[e("q-item-label",{attrs:{header:""}},[e("big",[t._v(t._s(n.label))])],1),t._l(t.selectedInvisibleFacets(n.code),(function(o){return e("q-item",{key:o.code,staticClass:"facetValue q-ml-md",attrs:{clickable:""},nativeOn:{click:function(e){return t.$emit("toogle-facet",n.code,o.code,t.contextKey)}}},[n.multiple?e("q-item-section",{attrs:{side:""}},[e("q-checkbox",{attrs:{dense:"",value:!0},on:{input:function(e){return t.$emit("toogle-facet",n.code,o.code,t.contextKey)}}})],1):t._e(),e("q-item-section",[t._v(t._s(o.label))]),e("q-item-section",{attrs:{side:""}},[t._v(t._s(o.count))])],1)})),t._l(t.visibleFacets(n.code,n.values),(function(o){return e("q-item",{key:o.code,staticClass:"facetValue q-ml-md",attrs:{clickable:""},nativeOn:{click:function(e){return t.$emit("toogle-facet",n.code,o.code,t.contextKey)}}},[n.multiple?e("q-item-section",{attrs:{side:""}},[e("q-checkbox",{attrs:{dense:"",value:t.isFacetValueSelected(n.code,o.code)},on:{input:function(e){return t.$emit("toogle-facet",n.code,o.code,t.contextKey)}}})],1):t._e(),e("q-item-section",[t._v(t._s(o.label))]),e("q-item-section",{attrs:{side:""}},[t._v(t._s(o.count))])],1)})),n.values.length>t.maxValues&&!t.isFacetExpanded(n.code)?e("q-btn",{attrs:{flat:""},on:{click:function(e){return t.expandFacet(n.code)}}},[t._v(t._s(t.$q.lang.vui.facets.showAll))]):t._e(),n.values.length>t.maxValues&&t.isFacetExpanded(n.code)?e("q-btn",{attrs:{flat:""},on:{click:function(e){return t.reduceFacet(n.code)}}},[t._v(t._s(t.$q.lang.vui.facets.showLess))]):t._e()]:t._e()],2)}))],2)},P=[],j={props:{facets:Array,selectedFacets:Object,contextKey:String,maxValues:{type:Number,default:5}},computed:{},data:function(){return{expandedFacets:[]}},methods:{facetByCode:function(t){return this.facets.filter((function(e){return e.code===t}))[0]},facetValueByCode:function(t,e){return this.facetByCode(t).values.filter((function(t){return t.code===e}))[0]},facetLabelByCode:function(t){return this.facetByCode(t).label},facetMultipleByCode:function(t){return this.facetByCode(t).multiple},facetValueLabelByCode:function(t,e){var n=this.facetValueByCode(t,e);return n?n.label:e},isFacetValueSelected:function(t,e){return this.selectedFacets[t].includes(e)},isFacetSelected:function(t){return!!this.selectedFacets[t]&&this.selectedFacets[t].length>0},isAnyFacetValueSelected:function(){return Object.keys(this.selectedFacets).some(function(t){return!this.facetMultipleByCode(t)}.bind(this))},expandFacet:function(t){this.isFacetExpanded(t)||this.$data.expandedFacets.push(t)},reduceFacet:function(t){this.isFacetExpanded(t)&&this.$data.expandedFacets.splice(this.$data.expandedFacets.indexOf(t),1)},isFacetExpanded:function(t){return this.$data.expandedFacets.includes(t)},selectedInvisibleFacets:function(t){return this.selectedFacets[t].filter((e=>!this.facetValueByCode(t,e))).map((t=>{var e={};return e.code=t,e.label=t,e.count=0,e}))},visibleFacets:function(t,e){return this.isFacetExpanded(t)?e:e.slice(0,this.maxValues)}}},F=j,A=u(F,E,P,!1,null,null,null),L=A.exports,M=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("q-input",{attrs:{label:"Longitude","stack-label":""},on:{input:t.updateJson},model:{value:t.inputObject.lon,callback:function(e){t.$set(t.inputObject,"lon",t._n(e))},expression:"inputObject.lon"}}),e("q-input",{attrs:{label:"Latitude","stack-label":""},on:{input:t.updateJson},model:{value:t.inputObject.lat,callback:function(e){t.$set(t.inputObject,"lat",t._n(e))},expression:"inputObject.lat"}})],1)},N=[],U={props:{value:{type:Object}},data:function(){return{inputObject:this.$props.value?this.$props.value:{}}},watch:{value:function(t){this.$data.inputObject=t||{},this.updateJson()}},beforeMount(){this.updateJson()},methods:{updateJson(){var t;this.$props.value&&(t=JSON.stringify({lon:this.$data.inputObject.lon,lat:this.$data.inputObject.lat}),this.$set(this.$props.value,"_v_inputValue",t)),this.$emit("input",this.$data.inputObject)}}},I=U,B=u(I,M,N,!1,null,null,null),V=B.exports,z=function(){var t=this,e=t._self._c;return e("div",[e("q-input",{attrs:{placeholder:t.$q.lang.vui.handles.placeholder,debounce:300,autofocus:"",outlined:"","bg-color":"white",dense:""},on:{input:t.searchHandles},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),e("q-list",{attrs:{bordered:"",dense:"",separator:""}},t._l(t.handles,(function(n){return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n.code,attrs:{clickable:""},on:{click:function(e){return t.VUi.methods.goTo(t.baseUrl+"hw/"+n.code)}}},[e("q-item-section",[t._v(" "+t._s(n.code)+" ")])],1)})),1)],1)},H=[],R={props:{baseUrl:{type:String,default:"/"}},data:function(){return{text:"",handles:[]}},methods:{searchHandles:function(t){t&&this.$http.post(this.baseUrl+"api/vertigo/handle/_search",{prefix:t}).then(function(t){this.$data.handles=t.data}.bind(this))}}},Y=R,K=u(Y,z,H,!1,null,null,null),G=K.exports,J=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},t._l(t.jsonAsObject,(function(n,o){return e("div",{key:o,class:"col-"+12/t.cols},[t.readonly?e("q-field",{attrs:{label:o,orientation:"vertical","stack-label":"",borderless:"",readonly:""}},[e("span",[t._v(t._s(n))])]):e("q-input",{attrs:{label:o,orientation:"vertical","stack-label":""},on:{input:t.updateJson},model:{value:t.jsonAsObject[o],callback:function(e){t.$set(t.jsonAsObject,o,e)},expression:"jsonAsObject[key]"}})],1)})),0)},X=[],W={props:{value:{type:String,required:!0},readonly:{type:Boolean,required:!0},cols:{type:Number,default:2}},data:function(){return{jsonAsObject:JSON.parse(this.$props.value)}},watch:{value:function(t){this.$data.jsonAsObject=JSON.parse(t)}},methods:{updateJson(){this.$emit("input",JSON.stringify(this.$data.jsonAsObject))}}},Z=W,Q=u(Z,J,X,!1,null,null,null),tt=Q.exports,et=function(){var t=this,e=t._self._c;return e("q-btn",{staticClass:"on-left",attrs:{round:"",dense:"",color:t.hasNew?"primary":"white",textColor:t.hasNew?"white":"primary",icon:t.count>0?t.icon:t.iconNone}},[t.count>0?e("q-badge",{attrs:{color:"red","text-color":"white",floating:""}},[t._v(t._s(t.count))]):t._e(),e("q-menu",{staticClass:"notifications"},[e("q-list",{staticStyle:{width:"300px"}},t._l(t.list,(function(n){return e("q-item",{key:n.uuid,attrs:{tag:"a",href:n.targetUrl}},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:t.toIcon(n.type),size:"2rem"}})],1),e("q-item-section",[e("q-item-label",[t._v(t._s(n.title))]),e("q-item-label",{attrs:{caption:"",lines:"3"}},[t._v(t._s(n.content))])],1),e("q-item-section",{attrs:{side:"",top:""}},[e("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.toDelay(new Date(n.creationDate))))])],1)],1)})),1)],1)],1)},nt=[],ot={props:{icon:{type:String,default:"notifications"},iconNone:{type:String,default:"notifications_none"},typeIconMap:{type:Object,default:function(){return{}}},baseUrl:{type:String,default:"/api/",required:!0}},data:function(){return{firstCall:!0,list:[],hasNew:!1,wasError:!1,count:0,timer:""}},created:function(){this.fetchNotificationsList(),this.timer=setInterval(this.fetchNotificationsList,5e3)},methods:{fetchNotificationsList:function(){this.$http.get(this.baseUrl+"x/notifications/api/messages",{timeout:5e3}).then(function(t){this.updateNotificationsData(t.data),this.wasError&&(clearInterval(this.timer),this.timer=setInterval(this.fetchNotificationsList,5e3)),this.wasError=!1}.bind(this)).catch(function(){this.wasError||(clearInterval(this.timer),this.timer=setInterval(this.fetchNotificationsList,6e4)),this.wasError=!0}.bind(this))},updateNotificationsData:function(t){const e=t.sort((function(t,e){return e.creationDate-t.creationDate}));var n=[],o=this.list[0];if(o){for(var a=0;a<e.length;a++)if(e[a].uuid!=o.uuid){if(e[a].creationDate<o.creationDate)break;n.push(e[a])}}else n=e;this.list=e,this.count=e.length,this.hasNew=n.length>0,this.firstCall||n.forEach(function(t){this.$q.notify({type:"info",icon:this.toIcon(t.type),message:t.title,detail:t.content,timeout:3e3,position:"bottom-right"})}.bind(this)),this.firstCall=!1},cancelAutoUpdate:function(){clearInterval(this.timer)},toIcon:function(t){var e=this.typeIconMap[t];return e||"mail"},toDelay:function(t){let e=o().utils.date.getDateDiff(Date.now(),t,"days");return e>0?e+" "+this.$q.lang.vui.notifications.days:(e=o().utils.date.getDateDiff(Date.now(),t,"hours"),e>0?e+" "+this.$q.lang.vui.notifications.hours:(e=o().utils.date.getDateDiff(Date.now(),t,"minutes"),e>0?e+" "+this.$q.lang.vui.notifications.minutes:(e=o().utils.date.getDateDiff(Date.now(),t,"seconds"),e+" "+this.$q.lang.vui.notifications.seconds)))}},beforeDestroy:function(){clearInterval(this.timer)}},at=ot,it=u(at,et,nt,!1,null,null,null),st=it.exports,rt=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:t.id}},[t._t("default")],2)},ct=[],lt=i(5015),ut={props:{id:{type:String,required:!0},initialZoomLevel:{type:Number},initialCenter:{type:Object}},methods:{onMapLoad:function(t){var e=this;function n(){e.olMap?(t(e.olMap),e.postInit()):setTimeout(n,50)}n()},postInit(){this.$props.initialZoomLevel&&this.olMap.getView().setZoom(this.$props.initialZoomLevel)}},mounted:function(){var t=new lt.View,e=new lt.layer.Tile({preload:4,source:new lt.source.OSM});this.olMap=new lt.Map({interactions:lt.interaction.defaults({onFocusOnly:!0}),target:this.$props.id,layers:[e],loadTilesWhileAnimating:!0,view:t}),this.$props.initialCenter&&this.olMap.getView().setCenter(lt.proj.fromLonLat([this.$props.initialCenter.lon,this.$props.initialCenter.lat])),this.olMap.on("moveend",function(t){var e=t.map.getView().calculateExtent(),n=lt.proj.transformExtent(e,"EPSG:3857","EPSG:4326"),a=lt.extent.getTopLeft(n),i=lt.extent.getBottomRight(n);o().utils.debounce(this.$emit("moveend",a,i),300)}.bind(this)),setTimeout(function(){this.olMap.on("click",function(t){t.stopPropagation(),o().utils.debounce(this.$emit("click",lt.proj.transform(t.coordinate,"EPSG:3857","EPSG:4326")),300)}.bind(this))}.bind(this),300)}},dt=ut,pt=u(dt,rt,ct,!1,null,null,null),ft=pt.exports,ht=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:t.id}},[e("div",{attrs:{id:t.id+"Popup"}},[t.popupDisplayed?e("q-card",{staticClass:"q-px-md"},[t._t("card",(function(){return[e("div",{staticClass:"text-subtitle2"},[t._v(t._s(t.objectDisplayed[t.nameField]))])]}),{objectDisplayed:t.objectDisplayed})],2):t._e()],1)])},mt=[],gt={props:{id:{type:String,required:!0},list:{type:Array},cluster:{type:Array},object:{type:Object},baseUrl:{type:String},field:{type:String,required:!0},nameField:{type:String},markerColor:{type:String,default:"#000000"},markerFont:{type:String,default:"Material Icons"},markerIcon:{type:String,default:"place"},markerSize:{type:Number,default:30},clusterCircleSize:{type:Number,default:20},clusterColor:{type:String,default:"#fff"},clusterCircleBorderColor:{type:String,default:"#000000"},clusterTextColor:{type:String,default:"#000000"},clusterTextSize:{type:Number,default:12},clusterTextFont:{type:String,default:"sans-serif"}},data:function(){return{popupDisplayed:!1,objectDisplayed:{},items:[],clusters:[],olMap:{},vectorSource:{},base32:"0123456789bcdefghjkmnpqrstuvwxyz"}},watch:{list:function(t){this.$data.items=t,this.$data.vectorSource.clear(),this.$data.vectorSource.addFeatures(this.features)},cluster:function(t){this.$data.items=[],this.$data.clusters=[];for(var e=0;e<t.length;e++)1==t[e].totalCount?this.$data.items=this.$data.items.concat(t[e].list):this.$data.clusters.push({geoHash:t[e].code,geoLocation:this.decode(t[e].code),totalCount:t[e].totalCount});this.$data.vectorSource.clear(),this.$data.vectorSource.addFeatures(this.features)},"object.geoLocation":function(){this.$data.vectorSource.clear(),this.$data.vectorSource.addFeatures(this.features)}},computed:{features:function(){var t=this.$props.field,e=this.$data.items.filter((function(e){return null!=e[t]})).map(function(e){var n;if(n="string"===typeof e[t]||e[t]instanceof String?JSON.parse(e[t]):e[t],null!=n){var o=new lt.Feature({geometry:new lt.geom.Point(lt.proj.fromLonLat([n.lon,n.lat]))});return this.$props.nameField&&(o.set("name",e[this.$props.nameField]),o.set("innerObject",e),o.set("totalCount",e.totalCount)),o}return null}.bind(this)),n=this.$data.clusters.filter((function(e){return null!=e[t]})).map(function(e){var n;if(n="string"===typeof e[t]||e[t]instanceof String?JSON.parse(e[t]):e[t],null!=n){var o=new lt.Feature({geometry:new lt.geom.Point(lt.proj.fromLonLat([n.lon,n.lat]))});return this.$props.nameField&&(o.set("name",e[this.$props.nameField]),o.set("innerObject",e),o.set("totalCount",e.totalCount)),o}return null}.bind(this));return e.concat(n)}},methods:{fetchList:function(t,e){this.$http.get(this.baseUrl+'_geoSearch?topLeft="'+t.lat+","+t.lon+'"&bottomRight="'+e.lat+","+e.lon+'"',{timeout:5e3}).then(function(t){this.$data.items=t.data,this.$data.vectorSource.clear(),this.$data.vectorSource.addFeatures(this.features)}.bind(this))},decode:function(t){const e=this.bounds(t),n=e.sw.lat,o=e.sw.lon,a=e.ne.lat,i=e.ne.lon;let s=(n+a)/2,r=(o+i)/2;return s=s.toFixed(Math.floor(2-Math.log(a-n)/Math.LN10)),r=r.toFixed(Math.floor(2-Math.log(i-o)/Math.LN10)),{lat:Number(s),lon:Number(r)}},bounds:function(t){if(0==t.length)throw new Error("Invalid geohash");t=t.toLowerCase();let e=!0,n=-90,o=90,a=-180,i=180;for(let r=0;r<t.length;r++){const s=t.charAt(r),c=this.$data.base32.indexOf(s);if(-1==c)throw new Error("Invalid geohash");for(let t=4;t>=0;t--){const s=c>>t&1;if(e){const t=(a+i)/2;1==s?a=t:i=t}else{const t=(n+o)/2;1==s?n=t:o=t}e=!e}}const s={sw:{lat:n,lon:a},ne:{lat:o,lon:i}};return s}},mounted:function(){this.$parent.onMapLoad(function(t){if(this.$data.olMap=t,this.$data.items=[],this.$data.clusters=[],this.$props.list)this.$data.items=this.$props.list;else if(this.$props.cluster)for(var e=0;e<this.$props.cluster.length;e++)1==this.$props.cluster[e].totalCount?this.$data.items=this.$data.items.concat(this.$props.cluster[e].list):this.$data.clusters.push({geoHash:this.$props.cluster[e].code,geoLocation:this.decode(this.$props.cluster[e].code),totalCount:this.$props.cluster[e].totalCount});else this.$props.object&&(this.$data.items=[this.$props.object]);this.$data.vectorSource=new lt.source.Vector({features:this.features});var n=new lt.source.Cluster({source:this.$data.vectorSource,distance:2*this.$props.clusterCircleSize}),a=new lt.layer.Vector({source:n}),i=new lt.style.Style({text:new lt.style.Text({font:this.$props.markerSize+"px "+this.$props.markerFont,text:this.$props.markerIcon,fill:new lt.style.Fill({color:this.$props.markerColor}),offsetY:0})}),s={};if(a.setStyle(function(t){for(var e=0,n=t.get("features"),o=0;o<n.length;o++){var a=n[o].get("totalCount");e+=a||1}if(e&&1!=e){var r=s[e];return r||(r=new lt.style.Style({image:new lt.style.Circle({radius:this.$props.clusterCircleSize,stroke:new lt.style.Stroke({color:this.$props.clusterCircleBorderColor}),fill:new lt.style.Fill({color:this.$props.clusterColor})}),text:new lt.style.Text({text:e.toString(),font:this.$props.clusterTextSize+"px "+this.$props.clusterTextFont,fill:new lt.style.Fill({color:this.$props.clusterTextColor})})}),s[e]=r),r}return i}.bind(this)),this.olMap.addLayer(a),this.features.length>0&&this.olMap.getView().fit(a.getSource().getSource().getExtent(),this.olMap.getSize()),this.olMap.on("moveend",function(t){var e=t.map.getView().calculateExtent(),n=lt.proj.transformExtent(e,"EPSG:3857","EPSG:4326"),a=lt.extent.getTopLeft(n),i=lt.extent.getBottomRight(n);this.baseUrl&&o().utils.debounce(this.fetchList({lat:a[0],lon:a[1]},{lat:i[0],lon:i[1]}),300),o().utils.debounce(this.$emit("moveend",a,i),300)}.bind(this)),this.$props.nameField){var r=new lt.Overlay({element:this.$el.querySelector("#"+this.$props.id+"Popup"),positioning:"bottom-center",stopEvent:!1,offset:[0,-20]});this.olMap.addOverlay(r),this.olMap.on("click",function(t){var e=this.olMap.forEachFeatureAtPixel(t.pixel,(function(t){return t}));if(e&&1==e.get("features").length){var n=e.getGeometry().getCoordinates();r.setPosition(n),this.$data.popupDisplayed=!0,this.$data.objectDisplayed=e.get("features")[0].get("innerObject"),t.stopPropagation(),o().utils.debounce(this.$emit("click",lt.proj.transform(n,"EPSG:3857","EPSG:4326")),300)}else this.$data.popupDisplayed=!1}.bind(this)),this.olMap.on("pointermove",function(t){if(t.dragging)this.$data.popupDisplayed=!1;else{var e=this.olMap.getEventPixel(t.originalEvent),n=this.olMap.hasFeatureAtPixel(e);this.olMap.getTargetElement().style.cursor=n?"pointer":""}}.bind(this))}else this.olMap.on("click",function(t){var e=this.olMap.forEachFeatureAtPixel(t.pixel,(function(t){return t}));if(e&&1==e.get("features").length){var n=e.getGeometry().getCoordinates();t.stopPropagation(),o().utils.debounce(this.$emit("click",lt.proj.transform(n,"EPSG:3857","EPSG:4326")),300)}}.bind(this))}.bind(this))}},vt=gt,bt=u(vt,ht,mt,!1,null,null,null),yt=bt.exports,xt=function(){var t=this,e=t._self._c;return e("q-field",t._b({scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{attrs:{name:"arrow_drop_down"}})]},proxy:!0},{key:"control",fn:function(){return[e("div",{staticClass:"self-center full-width no-outline",attrs:{tabindex:"0"}},[t._v(t._s(t.getSelectedLabel()))])]},proxy:!0}])},"q-field",t.$attrs,!1),[e("q-menu",{ref:"menu",attrs:{breakpoint:600,fit:""}},[e("q-tree",{attrs:{nodes:t.convertListToTree(t.$props.list,t.$props.subTreeKey),"node-key":t.$props.keyField,"label-key":t.$props.labelField,expanded:t.expandedNodes,selected:t.selectedNode},on:{"update:expanded":[function(e){t.expandedNodes=e},t.handleExpanded],"update:selected":[function(e){t.selectedNode=e},t.handleSelected]}})],1)],1)},wt=[],$t={props:{value:{type:String,required:!0},list:{type:Array,required:!0},keyField:{type:String,required:!0},labelField:{type:String,required:!0},parentKeyField:{type:String,required:!0},subTreeKey:{type:String,required:!1}},data:function(){return{selectedNode:this.$props.value,expandedNodes:[this.$props.value]}},watch:{value:function(t){this.$data.selectedNode=t}},methods:{handleSelected:function(t){this.$emit("input",this.$data.selectedNode),t&&this.$refs.menu.hide()},handleExpanded:function(){o().utils.debounce(this.$refs.menu.updatePosition,500)()},getSelectedLabel:function(){if(this.$data.selectedNode){let t=this.$props.list.find(function(t){return t[this.$props.keyField]===this.$data.selectedNode}.bind(this));return t[this.$props.labelField]}return null},convertListToTree:function(t,e){var n,o,a={},i=[];for(o=0;o<t.length;o+=1)a[t[o][this.$props.keyField]]=o,t[o].children=[];for(o=0;o<t.length;o+=1)n=t[o],n[this.$props.parentKeyField]?t[a[n[this.$props.parentKeyField]]].children.push(n):i.push(n);return e?[t[a[e]]]:i}}},Ct=$t,St=u(Ct,xt,wt,!1,null,null,null),_t=St.exports,kt={inserted:function(t,e,n){var o=e.expression;if(!window.watcherUpdates&&(window.watcherUpdates={originalDocumentTitle:document.title,updates_detected:!1,acceptedUpdates:function(){window.watcherUpdates.updates_detected=!1,document.title=window.watcherUpdates.originalDocumentTitle},beforeWindowUnload:function(t){window.watcherUpdates.updates_detected&&(t.preventDefault(),t.returnValue="Voulez-vous quitter cette page ? \n Les modifications que vous avez apportées ne seront peut-être pas enregistrées")}},window.addEventListener("beforeunload",window.watcherUpdates.beforeWindowUnload),n.context.$root.uiMessageStack)){var a=n.context.$root.uiMessageStack,i=a.globalErrors.length>0;for(let t of o.split(","))if(i=i||a.objectFieldErrors[t],i)break;i&&(window.watcherUpdates.updates_detected=!0)}t.addEventListener("click",window.watcherUpdates.acceptedUpdates);for(let s of o.split(","))n.context.$root.$watch("vueData."+s,(function(){window.watcherUpdates.updates_detected=!0,document.title="*"+window.watcherUpdates.originalDocumentTitle}),{deep:!0})},unbind:function(){window.removeEventListener("beforeunload",window.watcherUpdates.beforeWindowUnload)}},Dt={bind:function(t,e,n){var o=e.value;o&&!window.autofocus&&(window.autofocus=!0,n.context.$nextTick((()=>t.focus())))}},qt={update:function(t,e,n){n.context.$nextTick((()=>{window.watcherUpdates&&window.watcherUpdates.updates_detected?t.classList.remove("hidden"):t.classList.add("hidden")}))}},Ot=i(7203),Tt=i.n(Ot),Et={bind:function(t,e){const n=e.value.topOffset,a=e.value.topOffsetEl,i=e.value.leftOffset,s=e.value.leftOffsetEl,r=t.querySelector(".mini");for(var c=0;c<t.childNodes.length;c++){var l=t.childNodes[c];l.classList&&!l.classList.contains("mini")&&l.classList.add("not-mini")}Tt().minifyHandler=function(){var e=Tt().minifyComputeOffset(n,a,0,"TOP"),o=Tt().minifyComputeOffset(i,s,0,"LEFT"),c=r.getBoundingClientRect().height-e,l=t.getBoundingClientRect().height;window.pageYOffset>l-c?(r.classList.add("visible"),r.style.top=0,r.style.paddingTop=e+"px",r.style.paddingLeft=o+"px"):(r.classList.remove("visible"),r.style.top=-c-e+"px")},Tt().minifyComputeOffset=function(t,e,n,o){var a=n;if(t)a=t;else if(e){var i=document.querySelector(e);"LEFT"===o?a=i.getBoundingClientRect().width+i.getBoundingClientRect().x:"TOP"===o&&(a=i.getBoundingClientRect().height+i.getBoundingClientRect().y)}return a},window.addEventListener("scroll",Tt().minifyHandler),window.addEventListener("resize",o().utils.throttle(Tt().minifyHandler,50))},componentUpdated:function(){const t=50,e=1e3;for(var n=t;n<e;n+=n)setTimeout(Tt().minifyHandler,n)},unbind:function(t){window.removeEventListener("scroll"),window.removeEventListener("resize");for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];n.classList&&n.classList.remove("not-mini")}}},Pt={inserted:function(t,e){const n=!!e.value.debug&&e.value.debug,a=e.value.startingOffset?e.value.startingOffset:24,i=e.value.fixedPos?e.value.fixedPos:24,s=a-i,r=e.value.scanner?e.value.scanner:i+30,c=t.querySelectorAll("a");c[0].classList.add("active");const l=o().utils.scroll.getScrollTarget(document.querySelector(c[0].hash));let u,d,p=[];n&&(u=Tt().createDebugLine("startLinear","absolute",0,"red"),d=Tt().createDebugLine("last","absolute",0,"red")),Tt().scrollSpyHandler=function(){if(n){var e=t,a=0,r=0;while(e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop))a+=e.offsetLeft-e.scrollLeft,r+=e.offsetTop-e.scrollTop,e=e.offsetParent;console.log("x: "+a),console.log("y: "+r+" (startingOffset)")}window.pageYOffset>s?t.style.top||(t.style.top=i+"px",t.style.width||(t.style.width=t.getBoundingClientRect().width+"px"),t.classList.add("fixed")):t.style.top&&(t.classList.remove("fixed"),t.style.top=null,t.style.width=t.getBoundingClientRect().width+"px");for(var u=o().utils.scroll.getScrollPosition(l),d=Tt().computeBreakPoints(u),p=0;p<c.length;p++)d[p]<=u&&(p>=c.length-1||u<d[p+1])?c[p].classList.add("active"):c[p].classList.remove("active")},Tt().computeBlockTop=function(t){var e=[];for(let n=0;n<c.length;n++){const o=c[n].hash,a=document.querySelector(o);a&&e.push(t+a.getBoundingClientRect().top)}return e},Tt().scrollTo=function(t){t.preventDefault();const e=t.target.hash,n=document.querySelector(e);for(var a=o().utils.scroll.getScrollPosition(l)+n.getBoundingClientRect().top-r,i=o().utils.scroll.getScrollPosition(l),s=Tt().computeBlockTop(i),u=Tt().computeBreakPoints(i),d=0;d<c.length;d++)if(c[d].hash==e){a=s[d]-r<u[d+1]||!u[d+1]?s[d]-r:u[d+1]-1;break}var p=200;o().utils.scroll.setScrollPosition(l,a,p)},Tt().computeBreakPoints=function(t){var e=Tt().computeBlockTop(t);const a=window.innerHeight||document.documentElement.clientHeight,i=o().utils.scroll.getScrollHeight(l),s=i-a,f=s;let h=f-a+r;for(let n=1;n<c.length;n++)if(e[n]-r>h){h=e[n]-r;break}const m=f-h;var g=[];g.push(0);for(let n=1;n<c.length;n++)e[n]-r>h?g[n]=h+m*(e[n]-h)/(i-h):g[n]=e[n]-r,g[n]=Math.round(g[n]);if(n){for(let t=1;t<c.length;t++){var v;p.length<t?(v=Tt().createDebugLine("navId#"+t,"absolute",0,"red"),p.push(v)):v=p[t-1],v.style.top=g[t]+r+"px"}u.style.top=h+r+"px",d.style.top=f+r+"px"}return g},Tt().createDebugLine=function(t,e,n,o){let a=document.createElement("div");return a.style.position=e,a.style.top=n+"px",a.style.border="none",a.style.borderTop=o+" solid 1px",a.style.width="100%",a.style.zIndex="10000",a.style.padding="0px",a.style.lineHeight="0px",a.style.fontSize="12px",a.style.color=o,a.innerHTML=t,document.querySelector("body").appendChild(a),a},t.classList.add("scroll-spy-nav");for(var f=0;f<c.length;f++)c[f].addEventListener("click",Tt().scrollTo);window.addEventListener("scroll",Tt().scrollSpyHandler),window.addEventListener("resize",o().utils.throttle(Tt().scrollSpyHandler,50))},unbind:function(t){t.classList.remove("scroll-spy-nav"),window.removeEventListener("scroll"),window.removeEventListener("resize");const e=t.querySelectorAll("a");for(var n=0;n<e.length;n++)e.removeEventListener("click")}};function jt(t,e){return new Date(t)-new Date(e)}function Ft(t){return"[object Date]"===Object.prototype.toString.call(t)}function At(t){return"number"===typeof t&&isFinite(t)}var Lt={onAjaxError:function(t){let e={type:"negative",message:"Network Error.",multiLine:!0,icon:"warning",timeout:2500};if(t){if(Object.prototype.hasOwnProperty.call(t.data,"redirect"))return void(window.location=t.data.redirect);if(Object.prototype.hasOwnProperty.call(t.data,"message")&&(e.message=t.data.message),401===t.status)return e.message=this.$q.lang.vui.ajaxErrors.code401,void this.$root.$emit("unauthorized",t);if(403===t.status?e.message=this.$q.lang.vui.ajaxErrors.code403:404===t.status?e.message=this.$q.lang.vui.ajaxErrors.code404:405===t.status?e.message=this.$q.lang.vui.ajaxErrors.code405:422===t.status?(e.message="",Object.keys(t.data).forEach(function(e){this.$data.uiMessageStack[e]=t.data[e]}.bind(this))):t.status>=500&&(e.message=this.$q.lang.vui.ajaxErrors.code500),t.statusText&&422!==t.status&&(e.message=t.statusText),Object.prototype.hasOwnProperty.call(t,"data"))if(Object.prototype.hasOwnProperty.call(t.data,"message")&&t.data.message&&t.data.message.length>0)e.message=t.data.message;else if(Object.prototype.hasOwnProperty.call(t.data,"globalErrors")&&t.data.globalErrors&&t.data.globalErrors.length>0){var n=this.uiMessageStackToNotify(t.data);n.forEach(function(t){this.$q.notify(t)}.bind(this)),e.message=""}}e.message.length>0&&this.$q.notify(e)},uiMessageStackToNotify:function(t){if(t){var e=[];return Object.prototype.hasOwnProperty.call(t,"globalErrors")&&t.globalErrors&&t.globalErrors.length>0&&t.globalErrors.forEach((function(t){e.push({type:"negative",message:t,multiLine:!0,timeout:2500})})),Object.prototype.hasOwnProperty.call(t,"globalWarnings")&&t.globalWarnings&&t.globalWarnings.length>0&&t.globalWarnings.forEach((function(t){e.push({type:"warning",message:t,multiLine:!0,timeout:2500})})),Object.prototype.hasOwnProperty.call(t,"globalInfos")&&t.globalInfos&&t.globalInfos.length>0&&t.globalInfos.forEach((function(t){e.push({type:"info",message:t,multiLine:!0,timeout:2500})})),Object.prototype.hasOwnProperty.call(t,"globalSuccess")&&t.globalSuccess&&t.globalSuccess.length>0&&t.globalSuccess.forEach((function(t){e.push({type:"positive",message:t,multiLine:!0,timeout:2500})})),e}},getSafeValue:function(t,e,n){return this.$data.vueData[t]&&this.$data.vueData[t][e]?this.$data.vueData[t][e][n]:null},transformListForSelection:function(t,e,n){return this.$data.vueData[t].map((function(t){return{value:t[e],label:t[n].toString()}}))},paginationAndSortHandler:function(t){var e=t.pagination;let n=this.$data.componentStates,o=this.$data.vueData;var a=n[e.componentId].pagination;a.sortBy==e.sortBy&&a.descending==e.descending||e.sortBy&&(e.sortUrl?(e.page=1,this.$http.post(e.sortUrl,this.objectToFormData({sortFieldName:e.sortBy,sortDesc:e.descending,CTX:this.$data.vueData.CTX})).then(function(t){o[e.listKey]=t.data.model[e.listKey],this.$data.vueData.CTX=t.data.model["CTX"]}.bind(this))):this.$refs[e.componentId].sortMethod.apply(this.$refs[e.componentId],[o[e.listKey],e.sortBy,e.descending])),n[e.componentId].pagination=e},paginatedData:function(t,e){let n=this.$data.componentStates;var o=n[e].pagination;if(0!=o.rowsPerPage){var a=(o.page-1)*o.rowsPerPage,i=o.page*o.rowsPerPage;return this.$data.vueData[t].slice(a,i)}return this.$data.vueData[t]},sortCiAi:function(t,e,n){const o=this.colList.find((t=>t.name===e));if(void 0===o||void 0===o.field)return t;const a=!0===n?-1:1,i="function"===typeof o.field?t=>o.field(t):t=>t[o.field],s=new Intl.Collator;return t.sort(((t,e)=>{let n=i(t),r=i(e);return null===n||void 0===n?-1*a:null===r||void 0===r?1*a:void 0!==o.sort?o.sort(n,r,t,e)*a:!0===At(n)&&!0===At(r)?(n-r)*a:!0===Ft(n)&&!0===Ft(r)?jt(n,r)*a:"boolean"===typeof n&&"boolean"===typeof r?(n-r)*a:([n,r]=[n,r].map((t=>(t+"").toLocaleString())),s.compare(n,r)*a)}))},selectedFunction:function(t,e,n){this.$data.vueData[t][e]=n.value},searchAutocomplete:function(t,e,n,o,a,i,s,r){i.length<2?r():this.$http.post(a,this.objectToFormData({terms:i,list:t,valueField:e,labelField:n,CTX:this.$data.vueData.CTX})).then(function(t){var a=t.data.map((function(t){return{value:t[e],label:t[n].toString()}}));s(function(){this.$data.componentStates[o].options=a}.bind(this))}.bind(this)).catch((function(t){this.$q.notify(t.response.status+":"+t.response.statusText),s([])}))},loadAutocompleteById:function(t,e,n,o,a,i,s,r){var c;c=null!=r?this.$data.vueData[i][r][s]:this.$data.vueData[i][s],Array.isArray(c)?c.forEach((i=>this.loadMissingAutocompleteOption(t,e,n,o,a,i))):this.loadMissingAutocompleteOption(t,e,n,o,a,c)},loadMissingAutocompleteOption:function(t,e,n,o,a,i){!i||this.$data.componentStates[o].options.filter(function(t){return t.value===i}.bind(this)).length>0||(this.$data.componentStates[o].loading=!0,this.$http.post(a,this.objectToFormData({value:i,list:t,valueField:e,labelField:n,CTX:this.$data.vueData.CTX})).then(function(t){var a=t.data.map((function(t){return{value:t[e],label:t[n].toString()}}));this.$data.componentStates[o].options=this.$data.componentStates[o].options.concat(a)}.bind(this)).catch(function(t){this.$q.notify(t.response.status+":"+t.response.statusText)}.bind(this)).then(function(){this.$data.componentStates[o].loading=!1}.bind(this)))},decodeDate:function(t,e){return t===o().utils.date.formatDate(o().utils.date.extractDate(t,"DD/MM/YYYY"),"DD/MM/YYYY")?o().utils.date.formatDate(o().utils.date.extractDate(t,"DD/MM/YYYY"),e):t},encodeDate:function(t,e){return t===o().utils.date.formatDate(o().utils.date.extractDate(t,e),e)?o().utils.date.formatDate(o().utils.date.extractDate(t,e),"DD/MM/YYYY"):t},decodeDatetime:function(t,e){return t===o().utils.date.formatDate(o().utils.date.extractDate(t,"DD/MM/YYYY HH:mm"),"DD/MM/YYYY HH:mm")?o().utils.date.formatDate(o().utils.date.extractDate(t,"DD/MM/YYYY HH:mm"),e):t},encodeDatetime:function(t,e){return t===o().utils.date.formatDate(o().utils.date.extractDate(t,e),e)?o().utils.date.formatDate(o().utils.date.extractDate(t,e),"DD/MM/YYYY HH:mm"):t},sortDatesAsString:function(t){return function(e,n){return o().utils.date.extractDate(e,t).getTime()>o().utils.date.extractDate(n,t).getTime()?1:-1}},goTo:function(t){window.location=t},openModal:function(t,e,n){if(e){var o=e;if(n&&Object.keys(n).length>0){var a=Object.keys(n).map((function(t){return t+"="+n[t]})).join("&");o=o+"?"+a}this.$data.componentStates[t].srcUrl=o}this.$data.componentStates[t].opened=!0},toogleFacet:function(t,e,n){let o=this.$data.vueData;var a=!1;o[n+"_facets"].forEach((function(e){e.code===t&&(a=e.multiple)}));var i=o[n+"_selectedFacets"][t];i?i.includes(e)?a?i.splice(i.indexOf(e),1):i.splice(0):i.push(e):o[n+"_selectedFacets"][t]=[e],this.search(n)},search:o().utils.debounce((function(t){let e=this.$data.componentStates,n=this.$data.vueData;var o=t+"_selectedFacets",a=n[t+"_criteriaContextKey"],i=this.vueDataParams([a]);i.append(o,JSON.stringify(n[o]));var s=e[t+"Search"].searchUrl,r=e[t+"Search"].collectionComponentId;if(e[r].pagination&&e[r].pagination.sortBy){var c=e[r].pagination;i.append("sortFieldName",c.sortBy),i.append("sortDesc",c.descending)}this.httpPostAjax(s,i,{onSuccess:function(n){if(e[r].pagination){var o=e[r].pagination;o.page=1,o.rowsNumber=n.data.model[t+"_list"].length}}})}),400),showMore:function(t){let e=this.$data.componentStates;var n=e[t].pagination.showMoreCount;n||(n=1,e[t].pagination.showMoreCount=n),e[t].pagination.rowsPerPage=e[t].pagination.rowsPerPage/n*(n+1)},vueDataToArray(t){return Array.isArray(t)?t:t?[t]:[]},obtainVueDataAccessor(t,e,n,o){return null!=n&&"null"!=n?null!=o?{get:function(){return t.$data.vueData[e][o][n]},set:function(a){t.$data.vueData[e][o][n]=a}}:{get:function(){return t.$data.vueData[e][n]},set:function(o){t.$data.vueData[e][n]=o}}:{get:function(){return t.$data.vueData[e]},set:function(n){t.$data.vueData[e]=n}}},uploader_changeIcon(){this.$q.iconSet.uploader.removeUploaded="delete_sweep",this.$q.iconSet.uploader.done="delete"},uploader_mounted(t,e,n,a){this.uploader_changeIcon();var i=this.$refs[t];i.vueDataAccessor=this.obtainVueDataAccessor(this,e,n,a);var s=i.vueDataAccessor,r=s.get();Array.isArray(r)||s.set(this.vueDataToArray(r)),s.set(s.get().filter((function(t,e,n){return n.indexOf(t)==e}))),s.get().forEach(function(e){var n={};n[i.fieldName]=e,this.$http.get(i.url,{params:n,credentials:i.withCredentials}).then(function(e){var n=e.data;i.files.some((t=>t.name===n.name))?console.warn("Component doesn't support duplicate file ",n):(n.__sizeLabel=o().utils.format.humanStorageSize(n.size),n.__progressLabel="100%",i.files.push(n),i.uploadedFiles.push(n),this.uploader_forceComputeUploadedSize(t))}.bind(this)).catch(function(t){t.response?this.$q.notify(t.response.status+":"+t.response.statusText+" Can't load file "+e):this.$q.notify(t+" Can't load file "+e)}.bind(this))}.bind(this))},uploader_dragenter(t){let e=this.$data.componentStates;e[t].dragover=!0},uploader_dragleave(t){let e=this.$data.componentStates;e[t].dragover=!1},uploader_drop(t,e){var n=this.$refs[e];n.addFiles(t.dataTransfer.files)},uploader_forceComputeUploadedSize:function(t){var e=this.$refs[t];e.uploadedSize=0,e.uploadedFiles.forEach((function(t){e.uploadedSize+=t.size})),e.uploadSize=e.uploadedSize,e.queuedFiles.forEach((function(t){e.uploadSize+=t.size}))},uploader_humanStorageSize:function(t){return o().utils.format.humanStorageSize(t)},uploader_addedFile:function(t,e){if(!t){var n=this.$refs[e],o=n.vueDataAccessor;n.removeUploadedFiles(),o.set([])}},uploader_uploadedFiles:function(t,e){var n=this.$refs[e],o=n.vueDataAccessor;t.files.forEach(function(t){t.fileUri=t.xhr.response,o.get().push(t.fileUri)}.bind(this))},uploader_failedFiles:function(t){t.files.forEach(function(t){this.onAjaxError({status:t.xhr.status,statusText:t.xhr.statusText,data:JSON.parse(t.xhr.response)})}.bind(this))},uploader_removeFiles:function(t,e){var n=this.$refs[e],o=n.vueDataAccessor,a=o.get();t.forEach(function(t){if(t.fileUri){var o=a.indexOf(t.fileUri),i={};i[n.fieldName]=t.fileUri,this.$http.delete(n.url,{params:i,credentials:n.withCredentials}).then(function(){n.multiple?a.splice(o,1):a.splice(0),this.uploader_forceComputeUploadedSize(e)}.bind(this)).catch(function(t){this.$q.notify(t.response.status+":"+t.response.statusText+" Can't remove temporary file")}.bind(this))}}.bind(this))},httpPostAjax:function(t,e,n){var o=Array.isArray(e)?this.vueDataParams(e):e;let a=this.$data.vueData,i=this.$data.uiMessageStack,s=this.isFormData(o)?o:this.objectToFormData(o);s.append("CTX",a.CTX),this.pushPendingAction(t),this.$http.post(t,s).then(function(t){t.data.model.CTX&&(a.CTX=t.data.model.CTX),Object.keys(t.data.model).forEach((function(e){"CTX"!=e&&(a[e]=t.data.model[e])})),Object.keys(t.data.uiMessageStack).forEach((function(e){i[e]=t.data.uiMessageStack[e]})),n&&n.onSuccess&&n.onSuccess.call(this,t)}.bind(this)).catch((function(t){n&&n.onError&&n.onError.call(this,t.response)})).finally(function(){this.removePendingAction(t)}.bind(this))},isPendingAction:function(t){return t?this.$data.componentStates.pendingAction.actionNames.includes(t):this.$data.componentStates.pendingAction.actionNames.length>0},pushPendingAction:function(t){this.$data.componentStates.pendingAction.actionNames.push(t)},removePendingAction:function(t){this.$data.componentStates.pendingAction.actionNames=this.$data.componentStates.pendingAction.actionNames.filter((e=>e!==t))},hasFieldsError:function(t,e,n){const o=this.$data.uiMessageStack.objectFieldErrors;if(o){var a=null!=n?t+"["+n+"]":t;return Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&Object.prototype.hasOwnProperty.call(o[a],e)&&o[a][e].length>0}return!1},getErrorMessage:function(t,e,n){const o=this.$data.uiMessageStack.objectFieldErrors;if(!o)return"";var a=null!=n?t+"["+n+"]":t;return Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&Object.prototype.hasOwnProperty.call(o[a],e)?o[a][e].join(", "):void 0},vueDataParams:function(t){for(var e=new FormData,n=0;n<t.length;n++){var o=t[n].split(".",2),a=o[0],i=o[1],s=this.$data.vueData[a];s&&"object"===typeof s&&!1===Array.isArray(s)?i?this._vueDataParamsKey(e,a,i,s):Object.keys(s).forEach(function(t){t.includes("_")||this._vueDataParamsKey(e,a,t,s)}.bind(this)):this.appendToFormData(e,"vContext["+a+"]",s)}return e},_vueDataParamsKey:function(t,e,n,o){let a=o[n];Array.isArray(a)?a&&0!=a.length?a.forEach(function(o,i){a[i]&&"object"===typeof a[i]?this.appendToFormData(t,"vContext["+e+"]["+n+"]",a[i]["_v_inputValue"]):this.appendToFormData(t,"vContext["+e+"]["+n+"]",a[i])}.bind(this)):this.appendToFormData(t,"vContext["+e+"]["+n+"]",""):a&&"object"===typeof a?this.appendToFormData(t,"vContext["+e+"]["+n+"]",a["_v_inputValue"]):this.appendToFormData(t,"vContext["+e+"]["+n+"]",a)},objectToFormData:function(t){const e=new FormData;return Object.keys(t).forEach(function(n){this.appendToFormData(e,n,t[n])}.bind(this)),e},appendToFormData:function(t,e,n){null!=n?t.append(e,n):t.append(e,"")},isFormData:function(t){return"undefined"!==typeof FormData&&t instanceof FormData},
/**
   * Capture the <CTL-V> paste event, only allow plain-text, no images.         *
   * see: https://stackoverflow.com/a/28213320         *
   * @param {object} evt - array of files
   * @author Daniel Thompson-Yvetot
   * @license MIT
   */
pastePlainTextCapture(t,e){if("INPUT"===t.target.nodeName)return;let n,o;t.preventDefault(),t.originalEvent&&t.originalEvent.clipboardData.getData?(n=t.originalEvent.clipboardData.getData("text/plain"),this.$refs[e].runCmd("insertText",n)):t.clipboardData&&t.clipboardData.getData?(n=t.clipboardData.getData("text/plain"),this.$refs[e].runCmd("insertText",n)):window.clipboardData&&window.clipboardData.getData&&(o||(o=!0,this.$refs[e].runCmd("ms-pasteTextOnly",n)),o=!1)},editorHandlerFixHelper(t,e,n,o,a,i){if(i.hasParents(t,!0))if(a.runCmd("formatBlock",o),i.range.commonAncestorContainer.hasChildNodes()){var s=!1,r=i.range.startContainer;while(r&&r!==i.el&&r.parentNode!==i.range.commonAncestorContainer)r=r.parentNode;var c=i.range.endContainer;while(c&&c!==i.el&&c.parentNode!==i.range.commonAncestorContainer)c=c.parentNode;i.range.commonAncestorContainer.childNodes.forEach((function(t){t===r&&(s=!0),s&&(t.outerHTML=t.outerHTML.replace(e,"")),t===c&&(s=!1)}))}else{var l=i.selection.focusNode.parentNode;while(l&&l!==i.el)t.includes(l.nodeName.toLowerCase())&&(l.outerHTML=l.outerHTML.replace(e,"")),l=l.parentNode}else a.runCmd("formatBlock",n)},editorHandlerBlockquoteFix(t,e,n){this.editorHandlerFixHelper(["blockquote"],/<\/?blockquote[^>]*\/?>/g,"blockquote","div",e,n)},editorHandlerParagrapheFix(t,e,n){this.editorHandlerFixHelper(["h1","h2","h3","h4","h5","h6","h7","h8","h9"],/<\/?h[1-9][^>]*\/?>/g,"div","div",e,n)}},Mt={ajaxErrors:{code401:"UnAuthorized, you may login with an authorized account",code403:"Forbidden, your havn&quote;t enought rights",code404:"API Route is Missing or Undefined",code405:"API Route Method Not Allowed",code500:"Server Error"},comments:{title:"Comments",inputLabel:"Insert here a comment",actionlabel:"Publish",cancel:"Cancel",save:"Save"},chatbot:{errorMessage:"An error occured sending the message",tryAgain:"Try again",suggestedAnswers:"Suggested answers",inputPlaceHolder:"Enter here a message",restartMessage:"Conversation is restarting"},facets:{showAll:"Show all",showLess:"Show less"},notifications:{days:"days",hours:"hours",minutes:"min",seconds:"s"},commands:{globalPlaceholder:"Type / to show all available commands",executeCommand:"Press Enter to execute command",linkLabel:"Show details"},uploader:{clear_all:"Clear All",removeUploaded:"Remove Uploaded Files",remove:"Remove",add:"Pick Files",upload:"Upload Files",clear:"Abort Upload"},handles:{placeholder:"Enter a handle : format is type/code"}},Nt={ajaxErrors:{code401:"Non autoris&eacute;, essayez de vous reconnecter",code403:"Vous n&quote;avez pas les droits suffisants pour effectuer cette action",code404:"API introuvable",code405:"API non autoris&eacute;e",code500:"Erreur serveur"},comments:{title:"Commentaires",inputLabel:"Insérer un commentaire ici",actionlabel:"Publier",cancel:"Annuler",save:"Sauver"},chatbot:{errorMessage:"Une erreur est survenue lors de l'envoi du message",tryAgain:"Essayez de nouveau",suggestedAnswers:"Réponses suggérées",inputPlaceHolder:"Ecrire un message",restartMessage:"Redémarrage de la conversation"},facets:{showAll:"Voir plus",showLess:"Voir moins"},notifications:{days:"jours",hours:"heures",minutes:"min",seconds:"s"},commands:{globalPlaceholder:"Taper / pour afficher les commandes disponibles",executeCommand:"Appuyer sur entrée pour executer la commande",linkLabel:"Voir les détails"},uploader:{clear_all:"Annuler tous",removeUploaded:"Supprimer tous",remove:"Supprimer",add:"Ajouter un fichier",upload:"Envoyer",clear:"Annuler"},handles:{placeholder:"Entrer un handle de la forme type/code"}};function Ut(t,e){let n={};return Object.keys(e).forEach((o=>n[o]=e[o].bind(t))),n}function It(t,e){t.component("v-chatbot",p),t.component("v-commands",b),t.component("v-comments",S),t.component("v-extensions-store",T),t.component("v-facets",L),t.component("v-geopoint-input",V),t.component("v-handles",G),t.component("v-json-editor",tt),t.component("v-notifications",st),t.component("v-map",ft),t.component("v-map-layer",yt),t.component("v-tree",_t),t.directive("alert-unsaved-updates",kt),t.directive("autofocus",Dt),t.directive("if-unsaved-updates",qt),t.directive("minify",Et),t.directive("scroll-spy",Pt),e.axios?(t.axios=e.axios,t.$http=e.axios,Object.defineProperties(t.prototype,{axios:{get(){return e.axios}},$http:{get(){return e.axios}},$vui:{get(){return Ut(this,Lt)}}}),o().lang.enUs&&(o().lang.enUs.vui=Mt),o().lang.fr&&(o().lang.fr.vui=Nt)):console.error("You have to install axios")}let Bt=Lt;function Vt(t,e){t.vueData=e.vueData,t.componentStates=e.componentStates,t.uiMessageStack=e.uiMessageStack,t.vuiLang=e.vuiLang}}(),s}()}));
//# sourceMappingURL=vertigo-ui.umd.min.js.map